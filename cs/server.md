## Server

### 프록시 서버(Proxy Server)
클라이언트가 서버와 통신할 때, 서버에 바로 접근하지 않고 자신을 통해 서버에 접근할 수 있도록 해주는 일종의 대리 서버이다.  
보통 일반 사용자는 지역이 제한되어있는 서비스를 이용하기 위해 우회하거나, 캐시를 통해 더 빠른 이용을 하기 위해 프록시 서버를 사용한다.

#### 종류
- Forward Proxy(Client relative)
  - 클라이언트를 대신해 서버와 소통한다.
  - 캐싱을 통해 빠른 서비스 이용 가능하도록 도와준다.
- Reverse Proxy(Server relative)
  - 서버를 대신해 클라이언트와 소통한다.
  - 분산처리(로드밸런싱) & 보안을 목적으로 프록시 서버를 이용한다.
    - 분산 처리
      - 사용자 증가로 인한 서버 과부하를 대비해 부하를 분산 할 수 있다.
        ```
                                 ->  서버 2
        클라이언트(N) -> 프록시 -> 서버 1
                                 ->  서버 3
        ```
#### 보안
- 클라이언트와 서버는 서로의 IP를 숨길 수 있다.
  - 요청 흐름: 클라이언트 <-> 프록시 <-> 서버

### 로드 밸런싱(load-balancing)
애플리케이션을 지원하는 리소스 풀 전체에 네트워크 트래픽을 균등하게 배포하는 방법

> document: https://aws.amazon.com/ko/what-is/load-balancing/

#### 구성
- Scale-Up
  - 물리적으로 서버의 사양을 높이는 하드웨어적인 방법으로 서버의 수를 늘리지 않고 프로그램 구현에 있어 변화가 필요없다는 장점이 있다.
    하지만 서버의 사양을 높이는데엔 굉장히 높은 비용이 들고, 하드웨어의 업그레이드엔 한계있다는 큰 단점이 있다.
    또한 사양을 높였으나 클라이언트의 요청이 더욱 많아진다면, 서버에 발생하는 부하는 여전히 해결하지 못한 상황이 초리된다.
- Scale-Out
  - 서버의 갯수를 늘려 하나의 서버가 감당하는 부하를 분산시키는 방법으로 많은 요청이 오더라도 여러대의 서버가 나눠서 처리하여 서버의 사양을 높이지 않고도 비교적 저렴한 방법으로 부하를 처리할 수 있다.
    이 같은 방법으로 서버를 증설 할때 요청을 여러 서버에 나눠 처리할 수 있도록 조절하는 장치 또는 기술을 로드 밸런서라 칭한다.
    ```
                                                 -> 서버 2
    흐름: 클라이언트 -> 인터넷 -> 로드 밸런서 -> 서버 1
                                                 -> 서버 3
    ```

#### 로드밸런싱 알고리즘
- 라운드로빈 방식(Round Robin Method)
  - 서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식
    클라이언트의 요청을 순서대로 분배하기 때문에 여러 대의 서버가 동일한 스펙을 갖고 있고,
    서버와의 연결(세션)이 오래 지속되지 않는 경우에 활용하기 적합하다.
- 가중 라운드로빈 방식(Weighted Round Robin Method)
  - 각각의 서버마다 가중치를 매기고 가중치가 높은 서버에 클라이언트 요청을 우선적으로 배분하여
    주로 서버의 트래픽 처리 능력이 상이한 경우 사용되는 부하 분산 방식
    - Ex: A 서버 = 가중치 5, B 서버 = 가중치 2 일때 로드밸런서는 라운드로빈 방식으로 A 서버에 5개 B 서버에 2개의 요청을 전달한다.
- IP 해시 방식(IP Hash Method)
  - 클라이언트의 IP 주소를 특정 서버로 매핑하여 요청을 처리하는 방식
    사용자의 IP를 해싱해(Hashing, 임의의 길이를 지닌 데이터를 고정된 길이의 데이터로 매핑하는 것, 또는 그러한 함수)
    로드를 분배하기 때문에 사용자가 항상 동일한 서버로 연결되는 것을 보장한다.
- 최소 연결 방식(Least Connection Method)
  - 요청이 들어온 시점에 가장 적은 연결상태를 보이는 서버에 우선적으로 트래픽을 배분
    자주 세션이 길어지거나, 서버에 분배된 트래픽들이 일정하지 않은 경우에 적합한 방식
- 최소 리스폰타임(Least Response Time Method)
  - 서버의 현재 연결 상태와 응답시간(Response Time, 서버에 요청을 보내고 최초 응답을 받을 때까지 소요되는 시간)을
    모두 고려하여 트래픽을 배분 가장 적은 연결 상태와 가장 짧은 응답시간을 보이는 서버에 우선적으로 로드를 배분하는 방식

#### 로드 밸런서 종류
1. L2: 데이터 전송 계층에서 Mac 주소를 바탕으로 로드 밸런싱
2. L3: 네트워크 계층에서 IP 주소를 바탕으로 로드 밸런싱
3. L4: 전송 계층에서 IP주소와 Port를 바탕으로 로드 밸런싱
4. L7: 응용 계층에서 클라이언트의 요청을 바탕으로 로드 밸런싱

**OSI 모형(Open Systems Interconnection Reference Model) 기준**
L4 로드밸런서와 L7 로드밸런서가 가장 많이 활용된다. 그 이유는 L4 로드밸런서부터 포트(Port)정보를 바탕으로 로드를 분산하는 것이 가능하기 때문이다.
한 대의 서버에 각기 다른 포트 번호를 부여하여 다수의 서버 프로그램을 운영하는 경우라면 최소 L4 로드밸런서 이상을 사용해야 한다.
